{# templates/partials/column_picker.html #}
{# Receives from parent template: columns (Vec<ColumnDef>), ctx (PageContext), table name as string "users" #}

<div class="col-picker" id="col-picker" hidden>
    <div class="col-picker__title">Columns</div>
    <ul class="col-picker__list" id="col-picker-list">
    {% for col in columns %}
        <li class="col-picker__item" draggable="true" data-key="{{ col.key }}">
            <span class="col-picker__handle" aria-hidden="true">&#8291;&#8291;</span>
            {% if col.always_visible %}
            <input type="checkbox" class="col-picker__check" checked disabled>
            {% else %}
            <input type="checkbox" class="col-picker__check" {% if col.visible %}checked{% endif %}>
            {% endif %}
            <span class="col-picker__label">{{ col.label }}</span>
            {% if col.always_visible %}
            <span class="col-picker__always-on">(always on)</span>
            {% endif %}
        </li>
    {% endfor %}
    </ul>
    <div class="col-picker__footer">
        {% if ctx.permissions.has("settings.manage") %}
        <button type="button" class="btn btn-sm" id="col-picker-set-global">Set as global default</button>
        {% endif %}
    </div>
</div>

{# Hidden form for saving columns â€” posts to /users/columns #}
<form id="col-picker-form" method="post" action="/users/columns" style="display:none">
    <input type="hidden" name="csrf_token" value="{{ ctx.csrf_token }}">
    <input type="hidden" name="columns" id="col-picker-columns-input">
    <input type="hidden" name="set_global" id="col-picker-set-global-input" value="false">
    <input type="hidden" name="redirect_to" id="col-picker-redirect-input" value="">
</form>

<script src="/static/js/column-picker.js"></script>

# Production environment override.
# Usage: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d

services:
  app-prod:
    build:
      context: .
      dockerfile: Dockerfile
    restart: unless-stopped
    depends_on:
      postgres:
        condition: service_healthy
    environment:
      APP_ENV: prod
      DATABASE_URL: postgresql://ahlt:${POSTGRES_PASSWORD:-ahlt_dev_pass}@postgres/ahlt_prod
      NEO4J_URI: bolt://neo4j:7687
      NEO4J_USER: neo4j
      NEO4J_PASSWORD: ${NEO4J_PASSWORD:-secretpass}
      SESSION_KEY: ${SESSION_KEY}
      HOST: 0.0.0.0
      PORT: 8080
      RUST_LOG: info
      COOKIE_SECURE: "true"
    ports:
      - "8082:8080"
